<#include "/tpl/common/_master.html" />

<#macro customBody>
    <div class="top-offset">
        <div class="container grid fluid">
            <div class="row">
                <div class="panel">
                    <div class="panel-header bg-lightBlue fg-white">Test Result Details <sub class="fg-lightTeal">${testResult.getTestName()}()</sub></div>
                    <div class="panel-content">
                        <div class="row">
                            <div class="span2">
                                <div>
                                    <div class="row subheader text-center"><@resultStatusSpan/></div>
                                    <div class="row">
                                        <#if testResult.getScreenshotUrl() != "">
                                        <img src="${testResult.getScreenshotUrl()}" class="shadow img-thumb" href="#"></img>
                                        </#if>
                                    </div>
                                </div>
                            </div>
                            <div class="span5">
                                <table id="result_details_table" class="table striped bordered hovered">
                                    <thead>
                                        <tr>
                                            <th>Property</th>
                                            <th>Value</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>ENV</td>
                                            <td><span>${testResult.getEnv()}</span></td>
                                        </tr>
                                        <tr>
                                            <td>Execution</td>
                                            <td>
                                                <a href="${CPATH}/execution/detail/${execution.getId()}">${execution.getName()}</a>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Executed During</td>
                                            <td><span>${testResult.getStartTimeAsString()} ~ ${testResult.getEndTimeAsString()}</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="span5">
                                <div class="accordion with-marker" data-role="accordion" >
                                    <div class="accordion-frame">
                                        <a href class="heading">Additional Execution Properties</a>
                                        <div class="content">
                                            <p>
                                                <table class="table striped bordered hovered">
                                                    <tbody>
                                                        <tr>
                                                            <td class="span4">Execution ID</td>
                                                            <td class="span8">${entry.getId()}</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Ran on Slave</td>
                                                            <td>${testResult.getSlaveName()}</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Execution Index</td>
                                                            <td>${entry.getIndex()}</td>
                                                        </tr>
                                                        <tr>
                                                            <td>JVM Options</td>
                                                            <td>${entry.getJvmOptions()}</td>
                                                        </tr>
                                                        <tr>
                                                            <td>TestNG Params</td>
                                                            <td>${entry.getParams()}</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <#if testResult.getMessage() != "">
            <#assign url = testResult.getMessage().split("Current url:")[1]>
            <div class="row">
                <span>Current URL: 
                    <a class="heading" href="${url}" target="_blank">${url}</a>
                </span>
            </div>
            <div class="row">
                <div class="accordion with-marker place-left span12" data-role="accordion" data-closeany="false">
                    <div class="accordion-frame">
                        <a class="heading collapsed" href="#">${testResult.getMessage().replaceAll("\r\n","<br/>").replaceAll(" Current url:.*","")}</a>
                        <div class="content" style="display: none;">
                            <p class="code-text bg-lightTeal"><small>${testResult.getStackTrace().replaceAll("\r\n","<br/>")}</small></p>
                        </div>
                    </div>
                </div>
            </div>
            </#if>
        </div>
    </div>
</#macro>

<#macro resultStatusSpan>
    <#assign labelClass="">
    <#if testResult.getExecResult() == EXEC_RESULT_SKIPPED>
        <#assign labelClass = "warning">
    <#elseif testResult.getExecResult() == EXEC_RESULT_PASSED>
        <#assign labelClass = "success">
    <#elseif testResult.getExecResult() == EXEC_RESULT_FAILED>
        <#assign labelClass = "error">
    </#if>
        <span class="label ${labelClass}">${testResult.getExecResultLabel()}</span>
</#macro>

<#macro customJavascript>
    <script src="${CPATH}/js/testresult.js" type="text/javascript"></script>
</#macro>

<@master/>